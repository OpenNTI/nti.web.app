$over-color: #f4f3f3;

@mixin contact-user-row{
	.contact-row{
		height: 50px;
		position: relative;
		cursor: pointer;

		&.x-item-selected, &.over {
			background-color: #f0f0f0;
			box-shadow: inset -1px 0 0 0 #f4f4f4;
		}

		.avatar {
			position: absolute;
			top: 0; left: 0;
			width: 50px;
			height: 50px;
			background: {
				size: cover;
				repeat: no-repeat;
				position: center;
			};
		}

		.presence {
			position: absolute;
			top: 23px; right: 15px;
			@include presence-style;
		}

		.nib {
			display: none;
			@include icon('add-contact');
			cursor: pointer;
			position: absolute;
			right: 8px;
			top: 17px;
			width: 18px;
			height: 17px;
			&:hover::after { @include sprite($icons,'add-contact_active'); }
		}

		&.not-contact {
			.presence { display: none; }
			.nib {
				display: block;
			}
		}

		.wrap {
			margin: 0 30px 0 60px;
			padding-top: 10px;
			.name {
				@include ellipse();
				overflow: hidden;
				font: normal 600 12px/15px $font;
				color: $primary-grey;
			}
			.status {
				@include ellipse();
				overflow: hidden;
				font: italic 400 12px/20px $font;
				color: $tertiary-grey;
			}
		}
	}
}


.contact-card {
	margin: 7px 0 0 10px;
	overflow: hidden;
	cursor: pointer;

	.x-menu-list-ct &,
	.selection-nt &{
		margin-left: 0;
		img {
			&.nib {
				background: transparent $icons no-repeat;
				@include sprite($icons,'add',$dimensions: true);
				margin-top: 10px;
				border: none !important;
				float: right;
			}
		}
	}

	&.x-menu-item-over,
	&.selection-item-over,
	.selection-item-over &
		{
		img.nib{
			opacity: 0.5;
			display: block;
			&:active {
				opacity: 1;
			}
		}
	}

	div.avatar, img{
		float: left;
		width: 32px;
		height: 32px;
		margin-top: 2px;
		cursor: pointer;

		&.nib {
			background: transparent $icons no-repeat;
			@include sprite($icons,'options',$dimensions: true);
			display: none;
			margin-top: 7px;
			border: none !important;
			float: right;
			cursor: pointer;
		}
	}

	img {
		&.public,
		&.group {
			background: url(../images/old_sprites/spr_groups_dark.png) 0 0 no-repeat;
		}
		&.group {
			background-position: -32px 0;
		}
	}

	div.avatar {
		position: relative;
		background-size: cover;

		&.public,
		&.group,
		&.list{
			&::after{
				background: $icons no-repeat;
				content: ' ';
				top: 0;
				left: 0;
				position: absolute;
			}
		}

		&.public::after{
			@include sprite($icons, 'dark-globe-26x26', $dimensions: true);
		}

		&.group::after{
			@include sprite($icons, 'dark-groups-32x22', $dimensions: true);
		}

		&.list::after{
			@include sprite($icons, 'dark-lists-31x21', $dimensions: true);
		}
	}

	&.card-over {

		border-radius: 1px;
		box-shadow: 0 0 0 4px #f1f1f1;
		background-color: #f1f1f1;

		img.nib{
			display: block;
			&:active,&:hover {
				@include sprite($icons,'options_active',$dimensions: true);
			}
		}
	}


	.card-body {
		margin-left: 44px;
	}

	&.offline{
		cursor: default;
		.name {
			color: $tertiary-grey;
		}
	}

	.name {
		@include menu-label-text-treatment;
		color: $primary-blue;
		cursor: pointer;
	}
	.status {
		color: $tertiary-grey;
		font: { size: 8pt; weight: 500; }
	}
}


.person-options-menu{

	.x-menu-item{
		&.x-menu-item-unchecked{
			&::after{
				content: '';
				position: absolute;
				left: 10px;
				top: 9px;
				outline: 0;
				background: $icons no-repeat;
				@include sprite($icons, 'checkbox-14', $dimensions:true);
			}
		}

		&.label{
			position: relative;
			margin-top: 10px;
			background: none !important;
			padding: 9px 5px 5px 32px !important;

			&::after{
				content: '';
				position: absolute;
				left: 10px; top: 6px;
				outline: 0;
				background: $icons no-repeat;
				@include sprite($icons, 'rhp-contact-flyout-settings', $dimensions:true);
			}
		}

		&.no-checkbox{
			background: none !important;
			&::after{
				background: none !important;
			}
		}

	}

	.close{
		position: absolute;
		cursor: pointer;
		top: 0px;
		right: 0px;
		width: 20px;
		height: 20px;
		&::after{
			cursor: pointer;
			position: absolute;
			top: 10px; right: 10px;
			content: '';
			background: $icons no-repeat;
			@include sprite($icons, 'rhp-close-lists', $dimensions:true);
		}
	}
}


.contact-popout .group-selection-list, .x-menu .group-selection-list{
	background: #ffffff;

	.toolbar{
		position: absolute;
		top: 0;
		width: 350px;
		height: 30px;
		left: 0;
		background-color: white;

		.title{
			position: relative;
			display: inline-block;
			cursor: pointer;
			color: #8a8989;
			font-size: 10px;
			font-weight: bold;
			text-transform: uppercase;
			padding: 13px 0 0 35px;

			&::after{
				content: '';
				position: absolute;
				left: 7px;
				top: 12px;
				outline: 0;
				background: $icons no-repeat;
				@include sprite($icons, 'rhp-contact-flyout-lists', $dimensions:true);
			}
		}

		.close {
			position: relative;
			float: right;
			display: inline-block;
			cursor: pointer;
			width: 30px;
			height: 30px;
			top: 0;
			right: 5px;


			&::after{
				position: absolute;
				top: 7px; left: 14px;
				content: '';

				background: $icons no-repeat;
				@include sprite($icons, 'rhp-close-lists', $dimensions:true);
			}
		}
	}

	.selection-list-ct {
		&::before{
			content: '';
			display: block;
			height: 2px;
			margin: 20px 0 10px 35px;
		}

		background: none;
		ul {
			//padding-bottom: 10px;

			&.disallowSelection{
				li.selection-list-item {
					background: none !important;
					padding: 5px;
				}
			}

			li.selection-list-item {
				padding: 5px 5px 5px 35px;
				color: $secondary-grey !important;
				background: transparent url(../images/icons/check_box.png) no-repeat 12px 7px;

				&.selection-item-over{
					background-color: $over-color;
					color: $secondary-grey !important;
					pointer: default;
				}


				&.selection-selected {
					background: transparent url(../images/icons/check_mark_a.png) no-repeat 15px 10px;
					&:active {
						background-image: url(../images/icons/check_mark_b.png);
					}
				}


				&.add-group-action {
					background: none;

					.input-wrap {
						left: -5px;
					}
				}

				.name{
					overflow: hidden;
					@include ellipse;
				}

				a {
					&:active, &:visited, &:link{
						border: 0 dotted $secondary-grey;
						border-bottom-width: 2px;
						color: $secondary-grey;
						display: inline-block;
						font-style: italic;
						padding: 0px 2px;
						text-decoration: none;
					}
				}

				input {
					box-shadow: none;
					background: transparent;
					height: auto;

					$value: text-shadow 0.5s, color 0.5s;

					@include experimental(transition, $value);

					&.error {
						@include experimental(transition, $value);
						@include animate(shake);
						color: red;
						text-shadow: 2px 2px 2px #ffc0c0;
					}
				}

				img.delete-group {
					display: none;
					background: transparent $icons no-repeat;
					@include sprite($icons,'remove',$dimensions: true);
					margin-top: 3px;
					border: none !important;
					float: right;
					cursor: pointer;
					opacity: 0.5;
					&:active {
						opacity: 1;
					}
				}

				&.selection-item-over {
					img.delete-group { display: block !important; }
				}
			}
		}
	}
}


.group-chat-initiator{
	background: #fafafa;
	overflow: hidden;
	position: absolute;
	bottom: 0; top: 0;
	left: 0; right: 0;
	background: #fafafa;

	div[id$=list]{
		position: absolute;
		bottom: 125px; top: 0;
		left: 0; right: 0;
		overflow: {
			x: hidden;
			y: auto; //scroll;
		}

		.contact-row{
			.presence { display: none; }

			.nib {
				display: block;
				top: 10px; right: 10px;
				width: 20px;
				height: 20px;
				&::after{ @include sprite($icons,'checkbox-light-unchecked',$dimensions: true);}
				&:hover::after { @include sprite($icons,'checkbox-light-unchecked_hover'); }
			}

			&.checked {
				.nib {
					&::after{ @include sprite($icons,'checkbox-light-checked',$dimensions: true);}
					&:hover::after { @include sprite($icons,'checkbox-light-checked_hover'); }
				}
			}
		}
	}

	div[id$=tokens], div[id$=buttons]{
		border-top: 1px solid #dcdcdc;
	}

	div[id$=tokens]{
		background: #fff;
		position: absolute;
		overflow: {
			x:hidden;
			y: auto; //scroll;
		}
		bottom: 45px;
		left: 0; right: 0;
		min-height: 80px;
		max-height: 180px;


		.tokens {
			margin-right: 0 !important;
		}
	}

	div[id$=buttons]{
		position: absolute;
		overflow: hidden;
		bottom: 0;
		left: 0; right: 0;
		height: 45px;

		div {
			position: absolute;
			height: 45px;
			bottom: 0;
			right: 0;
			font: normal normal 14px/45px $font;
			text-align: center;
			color: $secondary-grey;
			cursor: pointer;
			@include experimental(transition, all 0.5s);

			&.cancel {
				width: 85px;
				right: 95px;
			}

			&.start {
				width: 95px;
				font: italic bold 14px/44px $font;
				color: #ffffff;
				border: 1px solid #69a92b;
				background: #75bc30;

				&.disabled{
					cursor: default;
					border: 1px solid #d0d0d0;
					background: rgba(184,184,184,0.5);
					color: rgba(255,255,255,0.7);
				}
			}
		}
	}


}


.contacts-view {
	position: relative;
	overflow: hidden;
	box-shadow: inset -1px 0 0 0 #fff,
				inset 1px 0 0 0 #fff;

	&.offline {
		.contact-row::after {
			content: '';
			position: absolute;
			top: 0; left: 0; bottom: 0; right: 0;
			background: rgba(255, 255, 255, 0.5);
		}
	}

	@include contact-user-row;

	.contact-search,
	.contact-list,
	.contact-search-group-chat{
		position: absolute;
		top: 0; left: 0; right: 0; bottom: 40px;

		overflow: {
			x: hidden;
			y: auto; //scroll;
		}

		.empty-list {
			padding: 20px 0;
			font: italic 300 14px/28px $font;
			text-align: center;
			color: $tertiary-grey;
		}
	}

	.contact-search {
		display: none;
		z-index: 1;
	}

	&.searching {
		.contact-search {
			display:block;
		}
	}

	.button-row {
		position: absolute;
		bottom: 0; left: 0; right: 0;

		height: 40px;
		width: 100%;
		cursor: pointer;

		&.search {
			.search{
				width: 220px !important;
				background-color: #ffffff;
				input{
					background: #ffffff;
					visibility: visible;
					opacity: 1;
				}
			}
			.group-chat {
				width: 40px !important;
			}
		}

		& > div {
			@include experimental(transition, all 0.5s);
			border: 1px solid #ebebeb;
			border-bottom-width: 0;
			padding-left: 40px;
			white-space: nowrap;

			position: absolute !important;
			font: italic 400 14px/40px $font;
			color: $tertiary-grey;
			background: #fafafa;
			overflow: hidden;
			width: 130px;
			top: 0;

			&:hover {
				background-color: #ffffff;
			}

			&:last-of-type {
				border-right-width: 0;
			}

			&.search {
				left: 0;
				border-left-width: 0;
				padding-left: 35px;
				@include icon('rhp-search',$top:11px,$left:9px);
				&::after{ opacity: 0.6; }

				input {
					@include experimental(transition, opacity 0.5s);
					visibility: hidden;
					position: absolute;
					border: 0;
					background: #fafafa;

					font: normal 400 14px/25px $font;
					color: $primary-grey;
					height: 40px;
					top: 0; left: 30px; right: 26px;
					opacity: 0;
				}
				.clear {
					@include icon('clear_line');
					position: absolute;
					top: 14px;
					right: 10px;
					left: auto;

					margin: 0;
					width: 16px;
					height: 16px;
					padding: 0;
					border-width: 0;
				}
			}

			&.group-chat {
				right: 0;
				@include icon('rhp-group-chat',$top:11px,$left:7px);
				&:hover::after {
					@include sprite($icons,'rhp-group-chat_hover');
				}
			}
		}

		&.no-group-chat{
			&.search .search,
			.search { width: 260px !important; }
			.group-chat { display: none; }
		}
	}
}


.disabled-contacts-view{
	padding-top: 0px;
	color: $secondary-grey;

	.disabled-message-div{
		background-color: #f1f1f1;
		padding: 15px;

		.disabled-title{
			color: $primary-grey;
			padding-bottom: 3px;
			font-size: 16px;
			font-style: italic;
			&:active,&.active {
				background-position: -56px 0;
				&:hover{
					background-position: -84px 0;
				}
			}

			&:hover {
				background-position: -28px 0;
			}
		}
		.resend-consent {
			cursor: pointer;
			color: $primary-blue;
		}
	}
}


div.add-group-action{
	padding: 0 0 30px 15px;
	a {
		&:active, &:visited, &:link{
			border: 0 dotted $secondary-grey;
			border-bottom-width: 2px;
			color: $secondary-grey;
			display: inline-block;
			font-style: italic;
			padding: 0px 2px;
			text-decoration: none;
		}
	}

	input {
		box-shadow: none;
		background: transparent;

		$value: text-shadow 0.5s, color 0.5s;
		@include experimental(transition, $value);

		&.error {
			@include experimental(transition, $value);
			@include animate(shake);
			color: red;
			text-shadow: 2px 2px 2px #ffc0c0;
		}
	}
}


div.contact-buttons {
	background: #fff;
	text-transform: uppercase;
	div.contact-button{
		cursor: pointer;
		display: inline-block;
		position: relative;
		padding-left: 20px;
		margin-left: 20px;
		margin-top: 16px;
		font-weight: 600;
		font-size: 10px;
		color: $tertiary-grey;
		&:hover{
			color: $secondary-grey;
		}
	}

	div.join-group {
		@include icon('add-contact-14x14');
		&:hover::after{
			@include sprite($icons,'add-contact-14x14_hover',$dimensions: true);
		}
	}

	div.create-group {
		&::after {
			content: ' ';
			position: absolute;
			top: 1px; left: 0;
			background: transparent $icons no-repeat;
			@include sprite($icons,'create-group-14x10',$dimensions: true);
		}
		&:hover::after{
			@include sprite($icons,'create-group-14x10_hover',$dimensions: true);
		}
	}

	div.create-list {
		&::after {
			content: ' ';
			position: absolute;
			top: 1px; left: 0;
			background: transparent $icons no-repeat;
			@include sprite($icons,'create-list',$dimensions: true);
		}
		&:hover::after{
			@include sprite($icons,'create-list_hover',$dimensions: true);
		}
	}
}

#contacts {
	//margin: 0 0 0 10%;

	.x-panel-contacts {
		margin: 0 auto;
		width: 725px;
	}

	.nti-contacts-tabbar {
		.search {
			position: absolute;
			cursor: pointer;
			top: 0; right: 0;
			width: 153px;
			height: 50px;
			padding-top: 5px;
			color: $tertiary-grey;
			font: italic 400 14px/40px $font;

			&::after{
				content: ' ';
				position: absolute;
				top: 17px;
				right: 11px;
				background: transparent $icons no-repeat;
				@include sprite($icons,'search',$dimensions: true);
			}

			&::before{
				border: 0px solid #ededed;
				border-bottom-width: 0;
				content: ' ';
				position: absolute;
				top: 10px; left: -7px;
				right: 0;
				bottom: 9px;

			}

			&:active,
			&.active {
				&::before{
					border: 1px solid #ededed;
				}
			}
		}
	}

	.contact-card-container {
		border: 0 solid #f2f2f2;
		border-top-width: 1px;
		&:first-of-type { border-top-width: 0; }

		.contact-card{
			
		}
	}

	.contact-card{
		position: relative;
		overflow: hidden;
		min-height: 150px;
		margin: 10px 0 5px 0;

		.avatar {
			top: 3px;
			left: 3px;
			width: 140px;
			height: 140px;
			position: absolute;
			background-position: center;
			background-repeat: no-repeat;
			background-size: cover;
			box-shadow: 0 0 3.5px 0.5px rgba(30, 30, 30, 1);
		}

		.nib{		
			top: 40%;
			right: 20px;
			float: none;
			display: none;

			@include icon('options_active',$top: auto, $left: auto);
			position: absolute;
			margin-top: 10px;
			width: 20px;
			height: 20px;
		}

		.meta {
			margin: 15px 0 0 160px;

			[data-field],.separator{
				color: $primary-grey;
				font: normal 500 14px/25px $font;
			}

			.separator{ color: $tertiary-grey; }

			.name {
				display: block;
				padding-left: 10px;
				margin-left: -10px;//these two left margin/paddings allow overflow:hidden and still to get the decenders
				margin-bottom: 5px;
				font: italic 300 30px/40px $font;
				color: $primary-blue;
				overflow: hidden;
				@include ellipse;
				text-transform: none;
				max-width: 400px;
			}

			@include add-to-contacts;
			.add-to-contacts { display: none; }

			.actions {
				margin: 0;
				text-transform: uppercase;
				color: $secondary-grey;
				white-space: nowrap;
				font: normal 700 10px/25px $font;

				.chat,.message,.email {
					opacity: 0.8;
					cursor: pointer;
					display: inline-block;
					padding: 0 25px 0 20px;
					position: relative;

					&:hover {
						opacity: 1;
					}

					&::after{
						content: ' ';
						position: absolute;
						top: 4px; left: 0;
						background: $icons no-repeat;
					}
				}

				.chat{
					padding-left:25px;
					&::after {
						@include sprite($icons,'activity-chat',$dimensions: true);
					}
				}
				.email::after {
					@include sprite($icons,'account-email',$dimensions: true);
				}
				.message::after {
					left: 2px;
					@include sprite($icons,'activity-comment',$dimensions: true);
				}

			}
		}

		&.not-contact {
			.meta {
				.name { max-width: 340px; }
				.add-to-contacts { display: inline-block; }
			}
		}

		&:hover, &.active{
			.nib{
				display: block;
			}
		};
	}

	.contact-grouping {
		margin: 35px 0;
		position: relative;
		overflow: hidden;

		&:hover .x-component-nti-tool-action:not(.disabled) {
			.icon.options::after{ @include sprite($icons,'options-menu-card_hover'); }
		}


		.x-component-nti-tool-action{
			margin: 0 0 0 20px;
			.icon {
				&.options::after{
					@include sprite($icons,'options-menu',$dimensions: true);
				}
			}
			&:hover,&.over {
				&:not(.disabled){
					.icon {
						&.options::after{ @include sprite($icons,'options-menu_hover'); }
					}
				}
			}
		}

		.grouping-header{
			margin: 10px 0;
			white-space: nowrap;

			.tools{
				margin-top: 3px;
				float: right;
				.nti-tool-action{
					display: inline-block;
				}
			}

			.name{
				overflow: hidden;
				@include ellipse;
				max-width: 600px;
				display: inline-block;
				vertical-align: bottom;
			}

			span{
				white-space: nowrap;
				font: normal 300 26px/35px $font;
				color: $primary-grey;
			}

			span.count{
				padding-left: 0.5em;
				color: #b8b8b8;
			}
		}

		.show-more{
			cursor: pointer;
			position: relative;
			background: #f8f8f8;
			width: 140px; height: 140px;
			float: left;
			text-align: center;
			color: $primary-blue;
			font: italic 300 16px/30px $font;

			.dots {
				line-height: 0;
				margin-top: 50px;
				div {
					display: inline-block;
					background: $primary-blue;
					border-radius: 90px;
					width: 7px;
					height: 7px;
					overflow: hidden;
					margin: 5px;
				}
			}
		}


		.contact-card-container {
			float: left;
			width: 140px;
			height: 140px;
			border: none;
			margin:0;
			padding: 0;

			.contact-card {
				width: 140px;
				height: 140px;
				min-height: 0;
				margin:0;
				padding: 0;

				.avatar{
					position: static;
					top: initial; left: initial;
					box-shadow: none;
				}

				&.Offline {
					.meta {
						&::before{ background: $tertiary-grey; }
					}
				}

				&.idle {
					.meta::before{ background: #ebcd25; }
				}

				.nib{
					bottom: 8px;
					right: 5px;

					@include icon('share-options-gear_hover');
					position: absolute;

					width: 13px;
					height: 13px;
					top: auto;
					opacity: 0.4;

					&:hover{
						opacity: 0.8;
					};
				}

				.meta {
					&::before{
						content: ' ';
						background: #2db651;
						border-radius: 90px;
						width: 7px;
						height: 7px;
						overflow: hidden;
						z-index: 2;
						position: absolute;
						top: 10px;
						left: 5px;
					}

					position: absolute;
					bottom: 0; left: 0; right: 0;
					background: rgba(38,38,38,0.94);
					margin: 0;
					height: 28px;

					[data-field]:not(.name),.separator,.composite-line{
						display: none;
					}

					.name{
						font: italic 300 16px/27px $font;
						max-width: 95px;
						color: #ababab;
						margin: 0;
						padding: 0 0 0 20px;
						display: inline-block;
					}

					.add-to-contacts {
						margin: 0;
						padding: 0 0 0 25px;
						width: 0;
						border: 0;
						overflow: hidden;
					}

					.actions {
						display: inline;

						& > div {
							padding-right: 0;
							width: 0;
							overflow: hidden;
							&::after{
								top: 5px;
								left: 2px;
							}
						}
					}

				}

				&.not-contact {
					.meta {
						.name { max-width: 90px; }
						.add-to-contacts { display: inline-block; }
					}
				}
			}
		}
	}


	.contact-sub-view {
		.empty {
			background: #fff;
		}

		.contact {
			padding: 35px 30px;
		}
		.nav-outline{
			&.contact{
				padding: 0;
			}
			&.list, &.group, &.contact {
				.outline-list {
					margin-bottom: 40px;

				}

				.buttons {
					display: block;
					position: absolute;
					overflow: hidden;
					top: auto;
					height: 40px;
					left: 0; right: 0;
					bottom: 0;
					background: #fafafa;
					color: $tertiary-grey;
					font: italic 400 12px/20px $font;
					border: 0;
					border-top: 1px solid #f2f2f2;

					.contact-button{
						cursor: pointer;
						line-height: 40px;
						display: inline-block;
						margin: 0; padding: 0 0 0 30px;
						width: 50%;

						& ~ .contact-button {
							box-shadow: -1px 0 0 0 #f2f2f2;
						}
						&.join {
							@include icon('reply', $top: 13px, $left: 7px);
							&::after {
								opacity: 0.6;
							}
						}
						&.create {
							@include icon('editor-attach', $top: 14px, $left: 10px);
						}

						&.search{
							width: 100%;
							left: 0;
							border-left-width: 0;
							padding-left: 35px;
							@include icon('rhp-search',$top:11px,$left:9px);
							&::after{ opacity: 0.6; }

							input {
								@include experimental(transition, opacity 0.5s);
								visibility: hidden;
								position: absolute;
								border: 0;
								background: #fafafa;

								font: normal 400 14px/25px $font;
								color: $primary-grey;
								height: 40px;
								top: 0; left: 30px; right: 26px;
								opacity: 0;
							}

							.clear {
								@include icon('clear_line');
								position: absolute;
								top: 14px;
								right: 10px;
								left: auto;

								margin: 0;
								width: 16px;
								height: 16px;
								padding: 0;
								border-width: 0;
							}

							&.active{
								background-color: #ffffff;
								input{
									background: #ffffff;
									visibility: visible;
									opacity: 1;
								}
							}
						}
					}
				}

				&.searching {
					.contact-search {
						display:block;
					}
				}

				.contact-search{
					position: absolute;
					top: 50px; left: 0; right: 0; bottom: 40px;
					z-index: 10;
					display: none;

					overflow: {
						x: hidden;
						y: auto; //scroll;
					}

					.empty-list {
						padding: 20px 0;
						font: italic 300 14px/28px $font;
						text-align: center;
						color: $tertiary-grey;
					}

					@include contact-user-row;
					.contact-row{
						&.contact{
							padding: 10px 0 0 0;
						}
					}
				}
			}
		}

		.contact-grouping {
			background: #fff;
			margin: 0 0 5px 0;
			padding: 35px 30px;
		}
	}
}



