

@mixin contact-header {
	color: #8a8989;
	font-size: 10px;
	font-weight: 700;
	line-height: 20px;
	padding-bottom: 2px;
	text-transform: uppercase;
}

$over-color: #f4f3f3;


.x-panel.contacts-panel {
	//padding: 0 10px 20px 10px;

	&.x-collapsed .x-panel-header::after {
		@include sprite($icons,'expand',$dimensions: true);
	}

	.x-panel-body{
		padding: 0 10px 20px 10px;
	}

	.x-panel-header {
		&::after {
			content: ' ';
			position: absolute;
			top: 7px; left: 10px;
			background: transparent $icons no-repeat;
			@include sprite($icons,'collapse',$dimensions: true);
		}

		cursor: pointer;
		padding-left: 20px;
		padding-right: 10px;
		@include contact-header;

		span{
			cursor: pointer;
		}

		.x-tool {
			height: 20px;
			margin-left: 0px;

			.x-tool-options {
				opacity: 0.5;
				background: transparent $icons no-repeat;
				@include sprite($icons,'options',$dimensions: true);
				&:hover {
					opacity: 1;
				}
			}
		}
	}
}


.contact-card {
	margin: 7px 0 0 10px;
	overflow: hidden;
	cursor: pointer;

	.x-menu-list-ct &,
	.selection-nt &{
		margin-left: 0;
		img {
			&.nib {
				background: transparent $icons no-repeat;
				@include sprite($icons,'add',$dimensions: true);
				margin-top: 10px;
				border: none !important;
				float: right;

				.contacts-panel & {
					background: transparent $icons no-repeat;
					@include sprite($icons,'remove',$dimensions: true);
					margin-right: 5px;
				}
			}
		}
	}

	&.x-menu-item-over,
	&.selection-item-over,
	.selection-item-over &
		{
		img.nib{
			opacity: 0.5;
			display: block;
			&:active {
				opacity: 1;
			}
		}
	}

	div.avatar, img{
		float: left;
		width: 32px;
		height: 32px;
		margin-top: 2px;
		cursor: pointer;

		&.nib {
			background: transparent $icons no-repeat;
			@include sprite($icons,'options',$dimensions: true);
			display: none;
			margin-top: 7px;
			border: none !important;
			float: right;
			cursor: pointer;
		}
	}

	img {
		&.public,
		&.group {
			background: url(../images/old_sprites/spr_groups_dark.png) 0 0 no-repeat;
		}
		&.group {
			background-position: -32px 0;
		}
	}

	div.avatar {
		position: relative;
		background-size: cover;

		&.public,
		&.group,
		&.list{
			&::after{
				background: $icons no-repeat;
				content: ' ';
				top: 0;
				left: 0;
				position: absolute;
			}
		}

		&.public::after{
			@include sprite($icons, 'dark-globe-26x26', $dimensions: true);
		}

		&.group::after{
			@include sprite($icons, 'dark-groups-32x22', $dimensions: true);
		}

		&.list::after{
			@include sprite($icons, 'dark-lists-31x21', $dimensions: true);
		}
	}

	&.card-over {

		border-radius: 1px;
		box-shadow: 0 0 0 4px #f1f1f1;
		background-color: #f1f1f1;

		img.nib{
			display: block;
			&:active,&:hover {
				@include sprite($icons,'options_active',$dimensions: true);
			}
		}
	}


	.card-body {
		margin-left: 44px;
	}

	&.offline{
		cursor: default;
		.name {
			color: $tertiary-grey;
		}
	}

	.name {
		@include menu-label-text-treatment;
		color: $primary-blue;
		cursor: pointer;
	}
	.status {
		color: $tertiary-grey;
		font: { size: 8pt; weight: 500; }
	}
}


.contact-popout .group-selection-list, .x-menu .group-selection-list{
	background: #ffffff;

	.close {
		cursor: pointer;
		position: absolute;
		width: 30px;
		height: 30px;
		top: 0;
		right: 5px;


		&::after{
			position: absolute;
			top: 10px; left: 10px;
			content: '';

			background: $icons no-repeat;
			@include sprite($icons, 'rhp-close-lists', $dimensions:true);
		}
	}

	.selection-list-ct {
		&::before{
			color: #8a8989;
			font-size: 10px;
			font-weight: bold;
			content: 'SELECT LISTS';
			display: block;
			margin: 20px 0 5px 35px;
		}

		background: none;
		ul {
			//padding-bottom: 10px;

			&.disallowSelection{
				li.selection-list-item {
					background: none !important;
					padding: 5px;
				}
			}

			li.selection-list-item {
				padding: 5px 5px 5px 35px;
				color: $secondary-grey !important;
				background: transparent url(../images/icons/check_box.png) no-repeat 12px 7px;

				&.selection-item-over{
					background-color: $over-color;
					color: $secondary-grey !important;
					pointer: default;
				}


				&.selection-selected {
					background: transparent url(../images/icons/check_mark_a.png) no-repeat 15px 10px;
					&:active {
						background-image: url(../images/icons/check_mark_b.png);
					}
				}


				&.add-group-action {
					background: none;

					.input-wrap {
						left: -5px;
					}
				}

				.name{
					overflow: hidden;
					@include ellipse;
				}

				a {
					&:active, &:visited, &:link{
						border: 0 dotted $secondary-grey;
						border-bottom-width: 2px;
						color: $secondary-grey;
						display: inline-block;
						font-style: italic;
						padding: 0px 2px;
						text-decoration: none;
					}
				}

				input {
					box-shadow: none;
					background: transparent;
					height: auto;

					$value: text-shadow 0.5s, color 0.5s;

					@include experimental(transition, $value);

					&.error {
						@include experimental(transition, $value);
						@include animate(shake);
						color: red;
						text-shadow: 2px 2px 2px #ffc0c0;
					}
				}

				img.delete-group {
					display: none;
					background: transparent $icons no-repeat;
					@include sprite($icons,'remove',$dimensions: true);
					margin-top: 3px;
					border: none !important;
					float: right;
					cursor: pointer;
					opacity: 0.5;
					&:active {
						opacity: 1;
					}
				}

				&.selection-item-over {
					img.delete-group { display: block !important; }
				}
			}
		}
	}
}


.contacts-view {
	position: relative;
	overflow: hidden;
	box-shadow: inset -1px 0 0 0 #fff,
				inset 1px 0 0 0 #fff;

	.contact-row{
		height: 50px;
		position: relative;

		&.x-item-selected, &.over {
			background-color: #f0f0f0;
			box-shadow: inset -1px 0 0 0 #f4f4f4;
		}

		.avatar {
			position: absolute;
			top: 0; left: 0;
			width: 50px;
			height: 50px;
			background: {
				size: cover;
				repeat: no-repeat;
				position: center;
			};
		}

		.presence {
			position: absolute;
			top: 23px; right: 15px;
			@include presence-style;
		}

		.nib {
			display: none;
			@include icon('add-contact');
			cursor: pointer;
			position: absolute;
			right: 8px;
			top: 17px;
			width: 18px;
			height: 17px;
			&:hover::after { @include sprite($icons,'add-contact_active'); }
		}

		&.not-contact {
			.presence { display: none; }
			.nib {
				display: block;
			}
		}

		.wrap {
			margin: 0 30px 0 60px;
			padding-top: 10px;
			.name {
				@include ellipse();
				overflow: hidden;
				font: normal 600 12px/15px $font;
				color: $primary-grey;
			}
			.status {
				@include ellipse();
				overflow: hidden;
				font: italic 400 12px/20px $font;
				color: $tertiary-grey;
			}
		}
	}

	.contact-search,
	.contact-list {
		position: absolute;
		top: 0; left: 0; right: 0; bottom: 40px;

		overflow: {
			x: hidden;
			y: scroll;
		}
	}

	.contact-search {
		display: none;
	}

	&.searching {
		.contact-search {
			display:block;
		}
	}

	.button-row {
		position: absolute;
		bottom: 0; left: 0; right: 0;

		height: 40px;
		width: 100%;
		cursor: pointer;

		&.search {
			.search{
				width: 220px !important;
				background-color: #ffffff;
				input{
					background: #ffffff;
					visibility: visible;
					opacity: 1;
				}
			}
			.group-chat {
				width: 40px !important;
			}
		}

		& > div {
			@include experimental(transition, all 0.5s);
			border: 1px solid #ebebeb;
			border-bottom-width: 0;
			border-left-width: 0;
			padding-left: 40px;
			white-space: nowrap;

			position: absolute !important;
			font: italic 400 14px/40px $font;
			color: $tertiary-grey;
			background: #fafafa;
			overflow: hidden;
			width: 130px;
			top: 0;

			&:hover {
				background-color: #ffffff;
			}

			&:last-of-type {
				border-right-width: 0;
			}

			&.search {
				left: 0;
				padding-left: 35px;
				@include icon('rhp-search',$top:11px,$left:9px);
				&::after{ opacity: 0.6; }

				input {
					@include experimental(transition, opacity 0.5s);
					visibility: hidden;
					position: absolute;
					border: 0;
					background: #fafafa;

					font: normal 400 14px/25px $font;
					color: $primary-grey;
					height: 40px;
					top: 0; left: 30px; right: 26px;
					opacity: 0;
				}
				.clear {
					@include icon('clear_line');
					position: absolute;
					top: 14px;
					right: 10px;
					left: auto;

					margin: 0;
					width: 16px;
					height: 16px;
					padding: 0;
					border-width: 0;
				}
			}

			&.group-chat {
				right: 0;
				@include icon('rhp-group-chat',$top:11px,$left:7px);
				&:hover::after {
					@include sprite($icons,'rhp-group-chat_hover');
				}
			}
		}
	}
}


.disabled-contacts-view{
	padding-top: 0px;
	color: $secondary-grey;

	.disabled-message-div{
		background-color: #f1f1f1;
		padding: 15px;

		.disabled-title{
			color: $primary-grey;
			padding-bottom: 3px;
			font-size: 16px;
			font-style: italic;
			&:active,&.active {
				background-position: -56px 0;
				&:hover{
					background-position: -84px 0;
				}
			}

			&:hover {
				background-position: -28px 0;
			}
		}
		.resend-consent {
			cursor: pointer;
			color: $primary-blue;
		}
	}
}


div.add-group-action{
	padding: 0 0 30px 15px;
	a {
		&:active, &:visited, &:link{
			border: 0 dotted $secondary-grey;
			border-bottom-width: 2px;
			color: $secondary-grey;
			display: inline-block;
			font-style: italic;
			padding: 0px 2px;
			text-decoration: none;
		}
	}

	input {
		box-shadow: none;
		background: transparent;

		$value: text-shadow 0.5s, color 0.5s;
		@include experimental(transition, $value);

		&.error {
			@include experimental(transition, $value);
			@include animate(shake);
			color: red;
			text-shadow: 2px 2px 2px #ffc0c0;
		}
	}
}


div.contact-buttons {
	@include top-etch();
	text-transform: uppercase;
	div.contact-button{
		cursor: pointer;
		display: inline-block;
		position: relative;
		padding-left: 20px;
		margin-left: 20px;
		margin-top: 16px;
		font-weight: 600;
		font-size: 10px;
		color: $tertiary-grey;
		&:hover{
			color: $secondary-grey;
		}
	}

	div.join-group {
		@include icon('add-contact-14x14');
		&:hover::after{
			@include sprite($icons,'add-contact-14x14_hover',$dimensions: true);
		}
	}

	div.create-group {
		&::after {
			content: ' ';
			position: absolute;
			top: 1px; left: 0;
			background: transparent $icons no-repeat;
			@include sprite($icons,'create-group-14x10',$dimensions: true);
		}
		&:hover::after{
			@include sprite($icons,'create-group-14x10_hover',$dimensions: true);
		}
	}

	div.create-list {
		&::after {
			content: ' ';
			position: absolute;
			top: 1px; left: 0;
			background: transparent $icons no-repeat;
			@include sprite($icons,'create-list',$dimensions: true);
		}
		&:hover::after{
			@include sprite($icons,'create-list_hover',$dimensions: true);
		}
	}
}

#contacts {
	//margin: 0 0 0 10%;

	.x-panel-contacts {
		margin: 0 auto;
		width: 725px;
	}

	.nti-contacts-tabbar {
		.search {
			position: absolute;
			cursor: pointer;
			top: 0; right: 0;
			width: 32px;
			height: 50px;

			&::after{
				content: ' ';
				position: absolute;
				top: 17px; left: 5px;
				background: transparent $icons no-repeat;
				@include sprite($icons,'search',$dimensions: true);
			}

			&:active,
			&.active {
				&::before{
					border: 1px solid #ededed;
					border-bottom-width: 0;
					background: #ffffff;
					content: ' ';
					position: absolute;
					top: 10px; left: -7px;
					right: 0;
					bottom: 9px;
				}
			}
		}
	}

	.contact-card-container {
		border: 0 solid #f2f2f2;
		border-top-width: 1px;
		&:first-of-type { border-top-width: 0; }

		.contact-card{
			
		}
	}

	.contact-card{
		position: relative;
		overflow: hidden;
		min-height: 150px;
		margin: 10px 0 5px 0;

		.avatar {
			top: 3px;
			left: 3px;
			width: 140px;
			height: 140px;
			position: absolute;
			background-position: center;
			background-repeat: no-repeat;
			background-size: cover;
			box-shadow: 0 0 3.5px 0.5px rgba(30, 30, 30, 1);
		}

		.nib{		
			top: 40%;
			right: 20px;
			float: none;
			display: none;

			@include icon ('options_active',$top: auto, $left: auto);
			position: absolute;
			margin-top: 10px;
			width: 20px;
			height: 20px;
		}

		.meta {
			margin: 15px 0 0 160px;

			[data-field],.separator{
				color: $primary-grey;
				font: normal 500 14px/25px $font;
			}

			.separator{ color: $tertiary-grey; }

			.name {
				display: block;
				padding-left: 10px;
				margin-left: -10px;//these two left margin/paddings allow overflow:hidden and still to get the decenders
				margin-bottom: 5px;
				font: italic 300 30px/40px $font;
				color: $primary-blue;
				overflow: hidden;
				@include ellipse;
				text-transform: none;
				max-width: 400px;
			}

			@include add-to-contacts;
			.add-to-contacts { display: none; }

			.actions {
				margin: 0;
				text-transform: uppercase;
				color: $secondary-grey;
				white-space: nowrap;
				font: normal 700 10px/25px $font;

				.chat,.message,.email {
					opacity: 0.8;
					cursor: pointer;
					display: inline-block;
					padding: 0 25px 0 20px;
					position: relative;

					&:hover {
						opacity: 1;
					}

					&::after{
						content: ' ';
						position: absolute;
						top: 4px; left: 0;
						background: $icons no-repeat;
					}
				}

				.chat{
					padding-left:25px;
					&::after {
						@include sprite($icons,'activity-chat',$dimensions: true);
					}
				}
				.email::after {
					@include sprite($icons,'account-email',$dimensions: true);
				}
				.message::after {
					left: 2px;
					@include sprite($icons,'activity-comment',$dimensions: true);
				}

			}
		}

		&.not-contact {
			.meta {
				.name { max-width: 340px; }
				.add-to-contacts { display: inline-block; }
			}
		}

		&:hover{
			.nib{
				display: block;
			}
		};
	}

	.contact-grouping {
		margin: 35px 0;
		position: relative;
		overflow: hidden;

		.x-component-nti-tool-action{
			margin: 0 0 0 20px;
			.icon {
				&.chat::after {
					top: 4px;
					@include sprite($icons,'chat-18x12',$dimensions: true);
				}

				&.settings::after{
					@include sprite($icons,'settings-28x17',$dimensions: true);
					width: 18px;//crop off the down-arrow nib
				}
			}
			&:hover,&.over {
				&:not(.disabled){
					.icon {
						&.chat::after { @include sprite($icons,'chat-18x12_hover'); }
						&.settings::after{ @include sprite($icons,'settings-28x17_hover'); }
					}
				}
			}
		}

		.grouping-header{
			margin: 10px 0;

			.tools{
				margin-top: 3px;
				float: right;
				.nti-tool-action{
					display: inline-block;
				}
			}

			span{
				white-space: nowrap;
				font: normal 500 18px/25px $font;
				color: $primary-grey;
			}

			span.count{
				padding-left: 4px;
				color: #b8b8b8;
			}
		}

		.show-more{
			cursor: pointer;
			position: relative;
			background: #f8f8f8;
			width: 140px; height: 140px;
			float: left;
			text-align: center;
			color: #b8b8b8;
			font: italic 300 16px/30px $font;

			.dots {
				line-height: 0;
				margin-top: 50px;
				div {
					display: inline-block;
					background: #b8b8b8;
					border-radius: 90px;
					width: 7px;
					height: 7px;
					overflow: hidden;
					margin: 5px;
				}
			}
		}

		&.show-all {
			//remove our limiter
			.contact-card-container:nth-of-type(1n+15) { display: block; }
		}

		.contact-card-container {
			// 1*0+16=16, 1*1+16=17, 1*2+16=18, 1*n+16=...you get the idea...
			// Make the 15th and on instance hidden.
			&:nth-of-type(1n+15) { display: none; }

			float: left;
			width: 140px;
			height: 140px;
			border: none;
			margin:0;
			padding: 0;

			.contact-card {
				width: 140px;
				height: 140px;
				min-height: 0;
				margin:0;
				padding: 0;

				.avatar{
					position: static;
					top: initial; left: initial;
				}

				&.Offline {
					.meta {
						&::before{ background: $tertiary-grey; }
					}
				}

				&.idle {
					.meta::before{ background: #ebcd25; }
				}

				.nib{
					bottom: 8px;
					right: 5px;

					@include icon('share-options-gear_hover');
					position: absolute;

					width: 13px;
					height: 13px;
					top: auto;
					opacity: 0.4;

					&:hover{
						opacity: 0.8;
					};
				}

				.meta {
					&::before{
						content: ' ';
						background: #2db651;
						border-radius: 90px;
						width: 7px;
						height: 7px;
						overflow: hidden;
						z-index: 2;
						position: absolute;
						top: 10px;
						left: 5px;
					}

					position: absolute;
					bottom: 0; left: 0; right: 0;
					background: rgba(38,38,38,0.94);
					margin: 0;
					height: 28px;

					[data-field]:not(.name),.separator,.composite-line{
						display: none;
					}

					.name{
						font: italic 300 16px/27px $font;
						max-width: 95px;
						color: #ababab;
						margin: 0;
						padding: 0 0 0 20px;
						display: inline-block;
					}

					.add-to-contacts {
						margin: 0;
						padding: 0 0 0 25px;
						width: 0;
						border: 0;
						overflow: hidden;
					}

					.actions {
						display: inline;

						& > div {
							padding-right: 0;
							width: 0;
							overflow: hidden;
							&::after{
								top: 5px;
								left: 2px;
							}
						}
					}

				}

				&.not-contact {
					.meta {
						.name { max-width: 90px; }
						.add-to-contacts { display: inline-block; }
					}
				}
			}
		}
	}
}
